<!DOCTYPE html>
<html lang="en" class="h-full"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.3 -->
<title>Sistemas De Ficheros Avanzados Btrfs | javierpzh</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="Sistemas De Ficheros Avanzados Btrfs" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="En este post vamos a ver el sistema de ficheros Btrfs." />
<meta property="og:description" content="En este post vamos a ver el sistema de ficheros Btrfs." />
<link rel="canonical" href="https://www.javierpzh.com/blog/sistemas-de-ficheros-avanzados-Btrfs" />
<meta property="og:url" content="https://www.javierpzh.com/blog/sistemas-de-ficheros-avanzados-Btrfs" />
<meta property="og:site_name" content="javierpzh" />
<meta property="og:image" content="https://soopr.xyz/images/card?url=https://www.javierpzh.com/blog/sistemas-de-ficheros-avanzados-Btrfs" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-01-22T00:00:00+01:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="og:image" content="https://soopr.xyz/images/card?url=https://www.javierpzh.com/blog/sistemas-de-ficheros-avanzados-Btrfs" />
<meta property="twitter:title" content="Sistemas De Ficheros Avanzados Btrfs" />
<meta name="twitter:site" content="@" />
<script type="application/ld+json">
{"description":"En este post vamos a ver el sistema de ficheros Btrfs.","@type":"BlogPosting","headline":"Sistemas De Ficheros Avanzados Btrfs","dateModified":"2021-01-22T00:00:00+01:00","datePublished":"2021-01-22T00:00:00+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.javierpzh.com/blog/sistemas-de-ficheros-avanzados-Btrfs"},"url":"https://www.javierpzh.com/blog/sistemas-de-ficheros-avanzados-Btrfs","@context":"https://schema.org"}</script>
<script async defer data-soopr-token="" src="https://sdk.soopr.co/soopr.js"  ></script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="https://rsms.me/inter/inter.css">
  <script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.min.js" defer></script>
  <link rel="stylesheet" href="/assets/css/style.css">
    <link
      rel="stylesheet"
      href="/assets/vendor/@fortawesome/fontawesome-free/css/all.min.css"
    /><link type="application/atom+xml" rel="alternate" href="https://www.javierpzh.com/feed.xml" title="javierpzh" />

<link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="mask-icon" href="/assets/img/favicons/safari-pinned-tab.svg" color="#5bbad5">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">
</head>
<body class='h-full'><nav class="top-0 absolute z-50 w-full flex flex-wrap items-center justify-between px-2 py-3 navbar-expand-lg bg-gray-800">
  <div class="container px-4 mx-auto flex flex-wrap items-center justify-between">
    <div class="w-full relative flex justify-between lg:w-auto lg:static lg:block lg:justify-start">
      <a
        class="text-sm font-bold leading-relaxed inline-block mr-4 py-2 whitespace-nowrap uppercase text-white"
        href="/">
        javierpzh
      </a>
      <button
        class="cursor-pointer text-xl leading-none px-3 py-1 border border-solid border-transparent rounded bg-transparent block lg:hidden outline-none focus:outline-none"
        type="button"
        onclick="toggleNavbar('example-collapse-navbar')">
        <i class="text-white fas fa-bars"></i>
      </button>
    </div>
    <div
      class="lg:flex flex-grow items-center bg-white lg:bg-transparent lg:shadow-none hidden"
      id="example-collapse-navbar">
      <ul class="flex flex-col lg:flex-row list-none mr-auto">
        <li class="flex items-center">
          <a
            class="lg:text-white lg:hover:text-gray-300 text-gray-800 px-3 py-4 lg:py-2 flex items-center text-xs uppercase font-bold"
            href="/blog">
            <i class="lg:text-gray-300 text-gray-500 far fa-file-alt text-lg leading-lg mr-2"></i>
            Blog
          </a>
          <a
            class="lg:text-white lg:hover:text-gray-300 text-gray-800 px-3 py-4 lg:py-2 flex items-center text-xs uppercase font-bold"
            href="/about">
            <i class="lg:text-gray-300 text-gray-500 fas fa-child text-lg leading-lg mr-2"></i>
            Sobre mí
          </a>
        </li>
      </ul>
      <ul class="flex flex-col lg:flex-row list-none lg:ml-auto">
        <li class="flex items-center">
          <a
            class="lg:text-white lg:hover:text-gray-300 text-gray-800 px-3 py-4 lg:py-2 flex items-center text-xs uppercase font-bold"
            href="https://www.linkedin.com/in/javier-p%C3%A9rez-hidalgo/">
            <i class="lg:text-gray-300 text-gray-500 fab fa-linkedin-in text-lg leading-lg"></i>
            <span class="lg:hidden inline-block ml-2">LinkedIn</span>
          </a>
        </li>
        <li class="flex items-center">
          <a
            class="lg:text-white lg:hover:text-gray-300 text-gray-800 px-3 py-4 lg:py-2 flex items-center text-xs uppercase font-bold"
            href="https://github.com/javierpzh">
            <i class="lg:text-gray-300 text-gray-500 fab fa-github text-lg leading-lg"></i>
            <span class="lg:hidden inline-block ml-2">GitHub</span>
          </a>
        </li>
        <li class="flex items-center">
          <a
            class="lg:text-white lg:hover:text-gray-300 text-gray-800 px-3 py-4 lg:py-2 flex items-center text-xs uppercase font-bold"
            href="mailto:javieperezhidalgo01@gmail.com">
            <i class="lg:text-gray-300 text-gray-500 fas fa-envelope text-lg leading-lg"></i>
            <span class="lg:hidden inline-block ml-2">Correo</span>
            </a>
        </li>
      </ul>
    </div>
  </div>
</nav>
<article class="font-sans relative py-24 md:py-28 bg-white overflow-hidden" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="relative px-4 sm:px-6 lg:px-8">
    <div class="text-lg max-w-prose mx-auto mb-4">
      <h1
        class="mt-2 mb-2 text-3xl text-center-DIS leading-8 font-extrabold tracking-tight-DIS text-gray-800 sm:text-4xl sm:leading-10"
        itemprop="name headline">
        Sistemas De Ficheros Avanzados Btrfs</h1>
    </div>
    <p class="max-w-prose mx-auto mb-2 text-lg uppercase text-gray-500"><span class="font-bold tracking-wide"><time class="dt-published text-xs" datetime="2021-01-22T00:00:00+01:00" itemprop="datePublished">
        Jan 22, 2021
      </time></span></p>
    <!-- 
      Please sign up at https://www.soopr.co to personalize share and reaction buttons
    -->
    <div class="max-w-prose text-lg mx-auto mt-4 mb-8 soopr-btn soopr-btn-def" style="min-height: 36px;"></div>
  </header>

  <div class="prose prose-lg px-4 md:px-0 text-gray-700 mx-auto" itemprop="articleBody">
    <p>En este <em>post</em> vamos a ver el sistema de ficheros <strong>Btrfs</strong>.</p>

<h4 id="características">Características</h4>

<p><strong>Btrfs</strong> <em>(B-tree FS)</em> es un sistema de archivos <strong>copy-on-write</strong> <em>(CoW)</em> anunciado por <em>Oracle Corporation</em> para <em>GNU/Linux</em>. <em>Btrfs</em> existe porque los desarrolladores querían expandir la funcionalidad de un sistema de archivos para incluir funcionalidades adicionales tales como agrupación, instantáneas y sumas de verificación.</p>

<p>El proyecto comenzó en <em>Oracle</em>, pero desde entonces, otras compañías importantes han desempeñado un papel en el desarrollo, como pueden ser <em>Facebook</em>, <em>Intel</em>, <em>Netgear</em>, <em>Red Hat</em> y <em>SUSE</em>.</p>

<p>Veamos algunas características de este sistema de ficheros:</p>

<ul>
  <li>
    <p>2^64 bytes = 16 EiB <em>(Exbibyte)</em> tamaño máximo de archivo</p>
  </li>
  <li>
    <p>Empaquetado eficiente en espacio de archivos pequeños y directorios indexados</p>
  </li>
  <li>
    <p>Asignación dinámica de inodos (no se fija un número máximo de archivos al crear el sistema de archivos)</p>
  </li>
  <li>
    <p><em>Snapshots</em> escribibles y <em>snapshots</em> de <em>snapshots</em></p>
  </li>
  <li>
    <p>Subvolúmenes</p>
  </li>
  <li>
    <p><em>Mirroring</em> y <em>Striping</em> a nivel de objeto</p>
  </li>
  <li>
    <p>Comprobación de datos y metadatos</p>
  </li>
  <li>
    <p>Compresión</p>
  </li>
  <li>
    <p><em>Copy-on-write</em> del registro de todos los datos y metadatos</p>
  </li>
  <li>
    <p>Gran integración con <em>device-mapper</em> para soportar múltiples dispositivos, con varios algoritmos de RAID incluidos</p>
  </li>
  <li>
    <p>Comprobación del sistema de archivos sin desmontar y comprobación muy rápida del sistema de archivos desmontado</p>
  </li>
  <li>
    <p>Copias de seguridad incrementales eficaces y <em>mirroring</em> del sistema de archivos</p>
  </li>
  <li>
    <p>Modo optimizado para SSD</p>
  </li>
  <li>
    <p>Desfragmentación sin desmontar</p>
  </li>
</ul>

<h4 id="escenario-de-trabajo">Escenario de trabajo</h4>

<p>Para empezar a trabajar con este sistema de ficheros, he creado un escenario en <em>OpenStack</em> que se resume en una instancia con <em>Debian</em>, a la que le he añadido tres volúmenes de 1 GB cada uno, como podemos observar aquí:</p>

<pre>
root@btrfs:~# lsblk
NAME   MAJ:MIN RM SIZE RO TYPE MOUNTPOINT
vda    254:0    0   2G  0 disk
└─vda1 254:1    0   2G  0 part /
vdb    254:16   0   1G  0 disk
vdc    254:32   0   1G  0 disk
vdd    254:48   0   1G  0 disk
</pre>

<p>Pasemos con la instalación.</p>

<h4 id="instalación">Instalación</h4>

<p>Para instalar <em>Btrfs</em> en nuestro sistema <em>Debian</em>, tenemos disponible el paquete <strong>btrfs-tools</strong>, que incluye todas las herramientas y características de este sistema de ficheros.</p>

<pre>
apt install btrfs-tools -y
</pre>

<p>Ya habremos instalado las herramientas.</p>

<h4 id="gestión-de-los-discos">Gestión de los discos</h4>

<p>En primer lugar, vamos a formatear uno de estos volúmenes y asignarle como sistema de ficheros <em>Btrfs</em>. Para ello, hacemos uso de la herramienta <code class="language-plaintext highlighter-rouge">mkfs.()</code> seguido del dispositivo:</p>

<pre>
root@btrfs:~# mkfs.btrfs /dev/vdb
</pre>

<p>Comprobamos que hemos asignado este <em>filesystem</em> correctamente:</p>

<pre>
root@btrfs:~# lsblk -f
NAME   FSTYPE LABEL UUID                                 FSAVAIL FSUSE% MOUNTPOINT
vda                                                                     
└─vda1 ext4         9659e5d4-dd87-42af-bf70-0bb6f7b2e31b  846.4M    51% /
vdb    btrfs        800a0dc3-d7d2-433a-8445-69e0d09d99cd                
vdc
vdd
</pre>

<p>Efectivamente ya estaríamos gestionando el dispositivo <code class="language-plaintext highlighter-rouge">vdb</code> con <em>Btrfs</em>.</p>

<h4 id="raid">RAID</h4>

<p>¿Y qué pasa si quisiéramos crear un sistema <strong>RAID</strong> con los 3 nuevos volúmenes? Bien, pues para llevar a cabo esto, nos valdría con introducir el mismo comando que hemos utilizado para formatear un dispositivo, pero indicando los tres discos en este caso.</p>

<p>Esto ocurre ya que <em>Btrfs</em> lo interpreta como un RAID para su gestión aunque no lo estemos indicando. Si queremos indicar el tipo de RAID que debe crear, podemos utilizar los parámetros <code class="language-plaintext highlighter-rouge">-d</code> y <code class="language-plaintext highlighter-rouge">-m</code> para especificar el perfil de redundancia para los datos y metadatos. En mi caso, voy a crear un RAID 1, que recordemos que se caracteriza por duplicar el almacenamiento de los datos en todos los dispositivos:</p>

<pre>
root@btrfs:~# mkfs.btrfs -d raid1 -m raid1 /dev/vdb /dev/vdc /dev/vdd
btrfs-progs v4.20.1
See http://btrfs.wiki.kernel.org for more information.

/dev/vdb appears to contain an existing filesystem (btrfs).
ERROR: use the -f option to force overwrite of /dev/vdb
</pre>

<p>Al haber utilizado anteriormente el disco <code class="language-plaintext highlighter-rouge">vdb</code> nos avisa que ya tiene un sistema de ficheros y que si queremos asignarle nuevamente este <em>filesystem</em>, tendremos que indicar el parámetro <code class="language-plaintext highlighter-rouge">-f</code> y de esta manera forzarlo.</p>

<pre>
root@btrfs:~# mkfs.btrfs -f -d raid1 -m raid1 /dev/vdb /dev/vdc /dev/vdd
btrfs-progs v4.20.1
See http://btrfs.wiki.kernel.org for more information.

Label:              (null)
UUID:               1675b6b0-4741-4341-bb5b-403e1e7c2932
Node size:          16384
Sector size:        4096
Filesystem size:    3.00GiB
Block group profiles:
  Data:             RAID1           153.56MiB
  Metadata:         RAID1           153.56MiB
  System:           RAID1             8.00MiB
SSD detected:       no
Incompat features:  extref, skinny-metadata
Number of devices:  3
Devices:
   ID        SIZE  PATH
    1     1.00GiB  /dev/vdb
    2     1.00GiB  /dev/vdc
    3     1.00GiB  /dev/vdd
</pre>

<p>Vemos como efectivamente ahora poseen <em>Btrfs</em>:</p>

<pre>
root@btrfs:~# lsblk -f
NAME   FSTYPE LABEL UUID                                 FSAVAIL FSUSE% MOUNTPOINT
vda                                                                     
└─vda1 ext4         9659e5d4-dd87-42af-bf70-0bb6f7b2e31b  846.4M    51% /
vdb    btrfs        1675b6b0-4741-4341-bb5b-403e1e7c2932                
vdc    btrfs        1675b6b0-4741-4341-bb5b-403e1e7c2932                
vdd    btrfs        1675b6b0-4741-4341-bb5b-403e1e7c2932
</pre>

<p>Además de poseer este sistema de ficheros, apreciamos como los identificadores de los tres dispositivos son idénticos, esto se debe a que el sistema lo identifica como tan sólo uno.</p>

<p>Os preguntaréis como haríamos para añadir un nuevo disco a este RAID ya existente, antes de verlo, vamos a montar el sistema RAID en nuestro sistema:</p>

<pre>
root@btrfs:~# mount /dev/vdb /mnt/

root@btrfs:~# lsblk -f
NAME   FSTYPE LABEL UUID                                 FSAVAIL FSUSE% MOUNTPOINT
vda                                                                     
└─vda1 ext4         9659e5d4-dd87-42af-bf70-0bb6f7b2e31b  846.1M    51% /
vdb    btrfs        1675b6b0-4741-4341-bb5b-403e1e7c2932  734.9M     1% /mnt
vdc    btrfs        1675b6b0-4741-4341-bb5b-403e1e7c2932                
vdd    btrfs        1675b6b0-4741-4341-bb5b-403e1e7c2932                

root@btrfs:~# btrfs scrub start /mnt/
scrub started on /mnt/, fsid 1675b6b0-4741-4341-bb5b-403e1e7c2932 (pid=640)

root@btrfs:~# btrfs scrub status /mnt/
scrub status for 1675b6b0-4741-4341-bb5b-403e1e7c2932
	scrub started at Mon Jan 18 18:10:43 2021 and finished after 00:00:00
	total bytes scrubbed: 512.00KiB with 0 errors
</pre>

<p>Una vez montado nuestro RAID, vamos a añadir un nuevo dispositivo, en este caso el llamado <code class="language-plaintext highlighter-rouge">vde</code>:</p>

<pre>
root@btrfs:~# lsblk -f
NAME   FSTYPE LABEL UUID                                 FSAVAIL FSUSE% MOUNTPOINT
vda                                                                     
└─vda1 ext4         9659e5d4-dd87-42af-bf70-0bb6f7b2e31b  846.1M    51% /
vdb    btrfs        1675b6b0-4741-4341-bb5b-403e1e7c2932  581.3M     1% /mnt
vdc    btrfs        1675b6b0-4741-4341-bb5b-403e1e7c2932                
vdd    btrfs        1675b6b0-4741-4341-bb5b-403e1e7c2932                
vde
</pre>

<p>Vemos que no posee el sistema <em>Btrfs</em>, y es una unidad nueva, lo añadimos:</p>

<pre>
root@btrfs:~# btrfs device add /dev/vde /mnt/

root@btrfs:~# lsblk -f
NAME   FSTYPE LABEL UUID                                 FSAVAIL FSUSE% MOUNTPOINT
vda                                                                     
└─vda1 ext4         9659e5d4-dd87-42af-bf70-0bb6f7b2e31b  846.1M    51% /
vdb    btrfs        1675b6b0-4741-4341-bb5b-403e1e7c2932    1.1G     1% /mnt
vdc    btrfs        1675b6b0-4741-4341-bb5b-403e1e7c2932                
vdd    btrfs        1675b6b0-4741-4341-bb5b-403e1e7c2932                
vde    btrfs        1675b6b0-4741-4341-bb5b-403e1e7c2932                

root@btrfs:~# btrfs filesystem show
Label: none  uuid: 1675b6b0-4741-4341-bb5b-403e1e7c2932
	Total devices 4 FS bytes used 320.00KiB
	devid    1 size 1.00GiB used 595.12MiB path /dev/vdb
	devid    2 size 1.00GiB used 665.56MiB path /dev/vdc
	devid    3 size 1.00GiB used 441.56MiB path /dev/vdd
	devid    4 size 1.00GiB used 0.00B path /dev/vde
</pre>

<p>Ya habríamos añadido este nuevo dispositivo pero aún nos faltaría activar el balanceo de carga para que se reparta la información entre los discos, incluyendo el nuevo que hemos añadido.</p>

<pre>
root@btrfs:~# btrfs balance start --full-balance /mnt/
Done, had to relocate 5 out of 5 chunks

root@btrfs:~# btrfs filesystem show
Label: none  uuid: 1675b6b0-4741-4341-bb5b-403e1e7c2932
	Total devices 4 FS bytes used 320.00KiB
	devid    1 size 1.00GiB used 288.00MiB path /dev/vdb
	devid    2 size 1.00GiB used 416.00MiB path /dev/vdc
	devid    3 size 1.00GiB used 256.00MiB path /dev/vdd
	devid    4 size 1.00GiB used 448.00MiB path /dev/vde
</pre>

<p>En este punto, sí se habría añadido completamente el disco y su funcionamiento sería el correcto.</p>

<p>Para seguir, vamos a probar a ver que pasaría en caso de que uno de los discos fallara, por ejemplo el <code class="language-plaintext highlighter-rouge">vdd</code>, por tanto, el sistema ya no lo reconoce e identifica un fallo en el sistema RAID, y he añadido el nuevo disco <code class="language-plaintext highlighter-rouge">vdf</code> para que sustituya al anterior y así se pueda restaurar el RAID correctamente.</p>

<pre>
root@btrfs:~# lsblk -f
NAME   FSTYPE LABEL UUID                                 FSAVAIL FSUSE% MOUNTPOINT
vda                                                                     
└─vda1 ext4         9659e5d4-dd87-42af-bf70-0bb6f7b2e31b  846.1M    51% /
vdb    btrfs        1675b6b0-4741-4341-bb5b-403e1e7c2932    1.5G     1% /mnt
vdc    btrfs        1675b6b0-4741-4341-bb5b-403e1e7c2932                
vde    btrfs        1675b6b0-4741-4341-bb5b-403e1e7c2932                
vdf

root@btrfs:~# btrfs filesystem show
Label: none  uuid: 1675b6b0-4741-4341-bb5b-403e1e7c2932
	Total devices 4 FS bytes used 256.00KiB
	devid    1 size 1.00GiB used 288.00MiB path /dev/vdb
	devid    2 size 1.00GiB used 32.00MiB path /dev/vdc
	devid    4 size 1.00GiB used 416.00MiB path /dev/vde
	*** Some devices missing
</pre>

<p>Vemos como nos detecta el fallo debido a que falta un dispositivo, y procedemos a sustituirlo:</p>

<pre>
root@btrfs:~# btrfs device add /dev/vdf /mnt/ &amp;&amp; btrfs device delete /dev/vdd /mnt/

root@btrfs:~# btrfs filesystem show
Label: none  uuid: 1675b6b0-4741-4341-bb5b-403e1e7c2932
	Total devices 4 FS bytes used 320.00KiB
	devid    1 size 1.00GiB used 288.00MiB path /dev/vdb
	devid    2 size 1.00GiB used 448.00MiB path /dev/vdc
	devid    4 size 1.00GiB used 256.00MiB path /dev/vde
	devid    6 size 1.00GiB used 416.00MiB path /dev/vdf
</pre>

<p>Hecho esto, habríamos resuelto este problema y habríamos sustituido el disco estropeado.</p>

<p>Bien, ¿y si tuviéramos dudas entre elegir RAID mediante <em>Btrfs</em> o mediante la herramienta <code class="language-plaintext highlighter-rouge">mdadm</code>, qué diferencia tendríamos entre ellas? Pues para responder esta pregunta es necesario conocer las ventajas y los inconvenientes de cada una de las opciones, así que pasaremos a analizarlas.</p>

<p>Una ventaja de RAID software mediante <code class="language-plaintext highlighter-rouge">mdadm</code> es que sencillo de realizar, forma un sistema estable y tiene un mayor rendimiento. Por otro lado, con <em>Btrfs</em> los datos se encuentran protegidos con un mayor sistema de seguridad. Pero sobre todo, la principal diferencia, es que haciendo uso de <em>Btrfs</em>, podemos crear un RAID 1 con discos de diferentes tamaños, incluso con la posibilidad de ampliarlos, mientras que con <code class="language-plaintext highlighter-rouge">mdadm</code> es necesario el mismo tamaño en los discos. Por último, una cosa que no he comentado anteriormente y es bastante interesante, es que por ejemplo, hemos montado un RAID 1, que consta de 4 discos de 1 GB cada uno, y conociendo las características de este tipo de RAID, el espacio total sería de 1 GB, como el menor de sus discos, pues vamos a comprobar el tamaño de este RAID:</p>

<pre>
root@btrfs:~# df -h
Filesystem      Size  Used Avail Use% Mounted on

...

/dev/vdb        2.0G   17M  1.7G   1% /mnt
</pre>

<p>¡Anda! Resulta que duplica el tamaño esperado, y esto es porque <em>Btrfs</em> gestiona el almacenamiento de una manera distinta, ya que reparte la información entre los diferentes dispositivos, aprovechando el máximo espacio posible, al mismo tiempo que asegura que la información se encuentra lo más segura posible. Así que imaginemos que creamos un RAID 1 con discos de distintos tamaños, ya no tendríamos el inconveniente de que el tamaño será igual al menor de sus discos.</p>

<p>Lógicamente la elección de uno u otro es algo subjetivo y dependerá de gustos, costumbres y necesidades, pero en resumen, poseemos más flexibilidad y muchas más características útiles en el RAID con <em>Btrfs</em> respecto al RAID con <code class="language-plaintext highlighter-rouge">mdadm</code>.</p>

<h4 id="compresión">Compresión</h4>

<p>Como vimos al principio del artículo cuando enumerábamos las características de <em>Btrfs</em>, este sistema de ficheros posee la capacidad para realizar la llamada <strong>compresión al vuelo</strong>, por tanto, en este apartado vamos a realizar algunos ejercicios y pruebas de este funcionamiento.</p>

<p>Antes de empezar, me gustaría explicar un poco que significa este término y para qué nos sirve. Es la posibilidad de almacenar la información comprimida, y en el momento que necesitemos hacer uso de esta información, el propio sistema es capaz de descomprimirla, leerla y acto seguido, volverla a comprimir para almacenarla. Esto nos da la posibilidad de almacenar muchísima más información que la que en un principio podríamos guardar, ya que como sabemos, un archivo comprimido reduce bastante su tamaño original.</p>

<p>Existen dos maneras de compresión al vuelo, que son las llamadas <strong>ZLIB</strong> y <strong>LZO</strong>.</p>

<p>¿Y qué diferencias hay entre estas dos opciones?</p>

<ul>
  <li><strong>LZO</strong>: es una compresión mas rápida pero menos exigente, lo que penaliza la capacidad de compresión, es decir, no llega a comprimir tanto la información.</li>
  <li><strong>ZLIB</strong>: es más exigente y por ello, comprime más la información, con el <em>hándicap</em> en cuanto a tiempo y en cuanto a la carga de CPU, que es un poco mayor.</li>
</ul>

<p>En mi caso voy a utilizar la opción <em>LZIB</em>. La compresión con esta opción, se lleva a cabo con el siguiente comando:</p>

<pre>
mount -o compress=zlib /dev/(dispositivo) /(punto de montaje)/
</pre>

<p>En mi caso, voy a comprimir el volumen denominado <code class="language-plaintext highlighter-rouge">vdb</code>, por lo que utilizo el siguiente comando:</p>

<pre>
mount -o compress=zlib /dev/vdb /mnt/
</pre>

<p>Hay que recordar que esta unidad, pertenece al RAID 1 creado anteriormente, que constaba de 4 discos de 1 GB cada uno, obteniendo un espacio total de <strong>2 GB</strong>:</p>

<pre>
root@btrfs:~# btrfs filesystem show
Label: none  uuid: 1675b6b0-4741-4341-bb5b-403e1e7c2932
	Total devices 4 FS bytes used 256.00KiB
	devid    1 size 1.00GiB used 288.00MiB path /dev/vdb
	devid    2 size 1.00GiB used 448.00MiB path /dev/vdc
	devid    4 size 1.00GiB used 256.00MiB path /dev/vde
	devid    6 size 1.00GiB used 416.00MiB path /dev/vdf
</pre>

<p>Dicho esto, vamos a probar a introducir la máxima información posible, para comprobar que podemos almacenar más espacio del que realmente poseemos gracias a la compresión. Con el siguiente comando vamos crear un fichero lleno de ceros, y posteriormente, miraremos el espacio que realmente ocupa dicho fichero.</p>

<pre>
root@btrfs:~# dd if=/dev/zero of=/mnt/fichero
dd: writing to '/mnt/fichero': No space left on device
113354259+0 records in
113354258+0 records out
58037380096 bytes (58 GB, 54 GiB) copied, 835.45 s, 69.5 MB/s

root@btrfs:~# ls -la /mnt/ &amp;&amp; du -h /mnt/
total 56677152
drwxr-xr-x  1 root root          34 Jan 22 16:20 .
drwxr-xr-x 18 root root        4096 Jan 18 18:06 ..
-rw-r--r--  1 root root 58037380096 Jan 22 16:34 fichero

55G	/mnt/
</pre>

<p>¡Vaya! Resulta que dicho fichero ocupa alrededor de <strong>55 GB</strong>, cuando el espacio total del RAID era de 2 GB. Por si acaso, vamos a ver de nuevo los detalles de esta unidad:</p>

<pre>
root@btrfs:~# btrfs filesystem show
Label: none  uuid: 1675b6b0-4741-4341-bb5b-403e1e7c2932
	Total devices 4 FS bytes used 1.79GiB
	devid    1 size 1.00GiB used 1023.00MiB path /dev/vdb
	devid    2 size 1.00GiB used 1023.00MiB path /dev/vdc
	devid    4 size 1.00GiB used 1023.00MiB path /dev/vde
	devid    6 size 1.00GiB used 1023.00MiB path /dev/vdf
</pre>

<p>Y efectivamente, estamos almacenando un fichero comprimido de 55 GB, en un espacio real de 1.79 GiB.</p>

<h4 id="copy-on-write-cow">Copy on Write (CoW)</h4>

<p><strong>Copy on Write</strong> conocido también por sus siglas <strong>CoW</strong>, es una optimización que permite almacenar una sola vez copias de datos indistinguibles. Es en el momento en el que una de estas copias se modifica en el que se realiza físicamente la copia. Así, aquellas copias que no llegan a modificarse nunca, solo existen en apariencia y remiten a los datos originales.</p>

<p>Para realizar ejercicios y mostrar el funcionamiento de <em>CoW</em>, voy a eliminar en primer lugar, el fichero creado en el apartado anterior y de esta manera seguir trabajando con la totalidad del RAID, aunque también podría sacar un disco del RAID y trabajar con él, pero prefiero la primera opción.</p>

<pre>
root@btrfs:/mnt# ls
fichero

root@btrfs:/mnt# rm fichero

root@btrfs:/mnt# df -h /mnt
Filesystem      Size  Used Avail Use% Mounted on
/dev/vdb        2.0G   17M  1.7G   1% /mnt
</pre>

<p>En el apartado anterior trabajamos con el RAID, así que vamos a cambiar y ahora simplemente vamos a trabajar con un disco, para ello voy a eliminar el disco <code class="language-plaintext highlighter-rouge">vdf</code> del RAID y posteriormente desmontaré el sistema RAID, y montaré el nuevo disco en el sistema:</p>

<pre>
root@btrfs:~# btrfs device delete /dev/vdf /mnt/

root@btrfs:~# btrfs filesystem show
Label: none  uuid: 1675b6b0-4741-4341-bb5b-403e1e7c2932
	Total devices 3 FS bytes used 6.91MiB
	devid    1 size 1.00GiB used 352.00MiB path /dev/vdb
	devid    2 size 1.00GiB used 32.00MiB path /dev/vdc
	devid    4 size 1.00GiB used 320.00MiB path /dev/vde

root@btrfs:~# umount /mnt/

root@btrfs:~# mkfs.btrfs /dev/vdf
btrfs-progs v4.20.1
See http://btrfs.wiki.kernel.org for more information.

Label:              (null)
UUID:               d59c6498-b013-4bd5-bf6e-6e2838ce8894
Node size:          16384
Sector size:        4096
Filesystem size:    1.00GiB
Block group profiles:
  Data:             single            8.00MiB
  Metadata:         DUP              51.19MiB
  System:           DUP               8.00MiB
SSD detected:       no
Incompat features:  extref, skinny-metadata
Number of devices:  1
Devices:
   ID        SIZE  PATH
    1     1.00GiB  /dev/vdf

root@btrfs:~# mount /dev/vdf /mnt/
</pre>

<p>Ahora voy a proceder a crear un fichero que será con el que trabajaremos:</p>

<pre>
root@btrfs:~# dd if=/dev/zero of=/mnt/ficheroprueba bs=2048 count=100k
102400+0 records in
102400+0 records out
209715200 bytes (210 MB, 200 MiB) copied, 2.06027 s, 102 MB/s

root@btrfs:~# ls /mnt/
ficheroprueba

root@btrfs:~# btrfs fi usage /mnt
Overall:
    Device size:		   1.00GiB
    Device allocated:		 462.38MiB
    Device unallocated:		 561.62MiB
    Device missing:		     0.00B
    Used:			 200.92MiB
    Free (estimated):		 705.42MiB	(min: 424.61MiB)
    Data ratio:			      1.00
    Metadata ratio:		      2.00
    Global reserve:		  16.00MiB	(used: 0.00B)

Data,single: Size:344.00MiB, Used:200.20MiB
   /dev/vdf	 344.00MiB

Metadata,DUP: Size:51.19MiB, Used:352.00KiB
   /dev/vdf	 102.38MiB

System,DUP: Size:8.00MiB, Used:16.00KiB
   /dev/vdf	  16.00MiB

Unallocated:
   /dev/vdf	 561.62MiB
</pre>

<p>Vemos que el fichero ocupa un espacio de <strong>200 MB</strong>. Bien, ahora vamos a realizar una copia de éste. Le indicamos el parámetro <code class="language-plaintext highlighter-rouge">--reflink=always</code> para que nos permita realizar un clon del fichero, es decir, una copia aparente basada en <em>CoW</em>.</p>

<pre>
root@btrfs:~# cp --reflink=always /mnt/ficheroprueba /mnt/ficheropruebaCoW

root@btrfs:~# ls /mnt/
ficheroprueba  ficheropruebaCoW

root@btrfs:~# btrfs fi usage /mnt
Overall:
    Device size:		   1.00GiB
    Device allocated:		 462.38MiB
    Device unallocated:		 561.62MiB
    Device missing:		     0.00B
    Used:			 200.92MiB
    Free (estimated):		 705.42MiB	(min: 424.61MiB)
    Data ratio:			      1.00
    Metadata ratio:		      2.00
    Global reserve:		  16.00MiB	(used: 0.00B)

Data,single: Size:344.00MiB, Used:200.20MiB
   /dev/vdf	 344.00MiB

Metadata,DUP: Size:51.19MiB, Used:352.00KiB
   /dev/vdf	 102.38MiB

System,DUP: Size:8.00MiB, Used:16.00KiB
   /dev/vdf	  16.00MiB

Unallocated:
   /dev/vdf	 561.62MiB
</pre>

<p>Apreciamos que el nuevo fichero no ha afectado en absoluto al espacio ocupado del dispositivo, ya que aún no se ha realizado ninguna modificación.</p>

<h4 id="deduplicación">Deduplicación</h4>

<p>¿En qué consiste la <strong>deduplicación</strong>?</p>

<p>Consiste en identificar cuándo los datos se han escrito dos veces y combinarlos en una misma extensión del disco, con el objetivo de optimizar al máximo el espacio de almacenamiento utilizado, eliminando copias duplicadas o repetidas de datos.</p>

<p>Para hacer uso de la deduplicación de datos debemos instalar el siguiente paquete:</p>

<pre>
apt install duperemove -y
</pre>

<p>Vamos a utilizar de nuevo el dispositivo <code class="language-plaintext highlighter-rouge">vdf</code>, para ello voy a formatearlo de nuevo:</p>

<pre>
root@btrfs:~# umount /mnt

root@btrfs:~# mkfs.btrfs -f /dev/vdf
btrfs-progs v4.20.1
See http://btrfs.wiki.kernel.org for more information.

Label:              (null)
UUID:               6e1e1285-8652-445b-b44f-af22438387fc
Node size:          16384
Sector size:        4096
Filesystem size:    1.00GiB
Block group profiles:
  Data:             single            8.00MiB
  Metadata:         DUP              51.19MiB
  System:           DUP               8.00MiB
SSD detected:       no
Incompat features:  extref, skinny-metadata
Number of devices:  1
Devices:
   ID        SIZE  PATH
    1     1.00GiB  /dev/vdf

root@btrfs:~# mount /dev/vdf /mnt/
</pre>

<p>Ahora vamos a crear un fichero de <strong>100 MB</strong>:</p>

<pre>
root@btrfs:~# dd if=/dev/zero of=/mnt/pruebadeduplicacion bs=2048 count=50k
51200+0 records in
51200+0 records out
104857600 bytes (105 MB, 100 MiB) copied, 1.04235 s, 101 MB/s

root@btrfs:~# ls /mnt/
pruebadeduplicacion

root@btrfs:~# du -h /mnt/pruebadeduplicacion
100M	/mnt/pruebadeduplicacion

root@btrfs:~# df -h /mnt
Filesystem      Size  Used Avail Use% Mounted on
/dev/vdf        1.0G  117M  805M  13% /mnt

root@btrfs:~# btrfs fi usage /mnt
Overall:
    Device size:		   1.00GiB
    Device allocated:		 238.38MiB
    Device unallocated:		 785.62MiB
    Device missing:		     0.00B
    Used:			 100.57MiB
    Free (estimated):		 805.55MiB	(min: 412.74MiB)
    Data ratio:			      1.00
    Metadata ratio:		      2.00
    Global reserve:		  16.00MiB	(used: 0.00B)

Data,single: Size:120.00MiB, Used:100.07MiB
   /dev/vdf	 120.00MiB

Metadata,DUP: Size:51.19MiB, Used:240.00KiB
   /dev/vdf	 102.38MiB

System,DUP: Size:8.00MiB, Used:16.00KiB
   /dev/vdf	  16.00MiB

Unallocated:
   /dev/vdf	 785.62MiB
</pre>

<p>Una vez creado, apreciamos que en nuestro dispositivo se encuentran en uso <strong>100 MB</strong>, es decir, lo esperado, pero ahora vamos a almacenar una copia del mismo fichero:</p>

<pre>
root@btrfs:~# cp /mnt/pruebadeduplicacion /mnt/pruebadeduplicacion2

root@btrfs:~# ls /mnt
pruebadeduplicacion  pruebadeduplicacion2

root@btrfs:~# df -h /mnt
Filesystem      Size  Used Avail Use% Mounted on
/dev/vdf        1.0G  217M  705M  24% /mnt

root@btrfs:~# btrfs fi usage /mnt
Overall:
    Device size:		   1.00GiB
    Device allocated:		 350.38MiB
    Device unallocated:		 673.62MiB
    Device missing:		     0.00B
    Used:			 200.88MiB
    Free (estimated):		 705.49MiB	(min: 368.68MiB)
    Data ratio:			      1.00
    Metadata ratio:		      2.00
    Global reserve:		  16.00MiB	(used: 0.00B)

Data,single: Size:232.00MiB, Used:200.13MiB
   /dev/vdf	 232.00MiB

Metadata,DUP: Size:51.19MiB, Used:368.00KiB
   /dev/vdf	 102.38MiB

System,DUP: Size:8.00MiB, Used:16.00KiB
   /dev/vdf	  16.00MiB

Unallocated:
   /dev/vdf	 673.62MiB
</pre>

<p>Podemos ver como ahora se encuentran en uso <strong>200 MB</strong>.</p>

<p>Es el momento de aplicar la deduplicación, para ello aplicamos el siguiente comando:</p>

<pre>
root@btrfs:~# duperemove -dr /mnt
Gathering file list...
Using 1 threads for file hashing phase
[1/2] (50.00%) csum: /mnt/pruebadeduplicacion
[2/2] (100.00%) csum: /mnt/pruebadeduplicacion2
Total files:  2
Total hashes: 1600
Loading only duplicated hashes from hashfile.
Hashing completed. Using 1 threads to calculate duplicate extents. This may take some time.
[########################################]
Search completed with no errors.             
Simple read and compare of file data found 1 instances of extents that might benefit from deduplication.
Showing 2 identical extents of length 104857600 with id 19b81479
Start		Filename
0	"/mnt/pruebadeduplicacion2"
0	"/mnt/pruebadeduplicacion"
Using 1 threads for dedupe phase
[0x5649765e0c00] (1/1) Try to dedupe extents with id 19b81479
[0x5649765e0c00] Dedupe 1 extents (id: 19b81479) with target: (0, 104857600), "/mnt/pruebadeduplicacion2"
Comparison of extent info shows a net change in shared extents of: 209715200
</pre>

<p>Si observamos la salida del comando, podemos ver como nos hace referencia a ambos ficheros, pero, ¿realmente habremos ahorrado el espacio? Vamos a comprobarlo:</p>

<pre>
root@btrfs:~# ls /mnt
pruebadeduplicacion  pruebadeduplicacion2

root@btrfs:~# df -h /mnt
Filesystem      Size  Used Avail Use% Mounted on
/dev/vdf        1.0G  117M  805M  13% /mnt

root@btrfs:~# btrfs fi usage /mnt
Overall:
    Device size:		   1.00GiB
    Device allocated:		 238.38MiB
    Device unallocated:		 785.62MiB
    Device missing:		     0.00B
    Used:			 100.62MiB
    Free (estimated):		 805.50MiB	(min: 412.69MiB)
    Data ratio:			      1.00
    Metadata ratio:		      2.00
    Global reserve:		  16.00MiB	(used: 0.00B)

Data,single: Size:120.00MiB, Used:100.12MiB
   /dev/vdf	 120.00MiB

Metadata,DUP: Size:51.19MiB, Used:240.00KiB
   /dev/vdf	 102.38MiB

System,DUP: Size:8.00MiB, Used:16.00KiB
   /dev/vdf	  16.00MiB

Unallocated:
   /dev/vdf	 785.62MiB
</pre>

<p>¡Bien! Efectivamente la deduplicación ha surgido efecto y tan solo estamos ocupando <strong>100 MB</strong> en nuestro dispositivo gracias a <em>Btrfs</em>.</p>

<h4 id="redimensión">Redimensión</h4>

<p>En este apartado vamos a analizar las redimensiones del espacio en dispositivos que disponen de <em>Btrfs</em>.</p>

<p>Empezaremos viendo el caso de disminuir el espacio, para el que tendríamos que utilizar el siguiente comando:</p>

<pre>
root@btrfs:~# btrfs filesystem show /mnt/
Label: none  uuid: 6e1e1285-8652-445b-b44f-af22438387fc
	Total devices 1 FS bytes used 100.31MiB
	devid    1 size 1.00GiB used 238.38MiB path /dev/vdf

root@btrfs:~# btrfs filesystem resize -100M /mnt/
Resize '/mnt/' of '-100M'

root@btrfs:~# btrfs filesystem show /mnt/
Label: none  uuid: 6e1e1285-8652-445b-b44f-af22438387fc
	Total devices 1 FS bytes used 100.31MiB
	devid    1 size 924.00MiB used 238.38MiB path /dev/vdf
</pre>

<p>Hemos reducido el espacio del dispositivo en 100 MB.</p>

<p>Por el contrario, si lo que quisiéramos fuera aumentar el espacio utilizaríamos el mismo comando pero cambiando el signo a <code class="language-plaintext highlighter-rouge">+</code>:</p>

<pre>
root@btrfs:~# btrfs filesystem show /mnt/
Label: none  uuid: 6e1e1285-8652-445b-b44f-af22438387fc
	Total devices 1 FS bytes used 100.31MiB
	devid    1 size 924.00MiB used 238.38MiB path /dev/vdf

root@btrfs:~# btrfs filesystem resize +100M /mnt/
Resize '/mnt/' of '+100M'

root@btrfs:~# btrfs filesystem show /mnt/
Label: none  uuid: 6e1e1285-8652-445b-b44f-af22438387fc
	Total devices 1 FS bytes used 100.31MiB
	devid    1 size 1.00GiB used 238.38MiB path /dev/vdf
</pre>

<p>Hemos aumentado el espacio del dispositivo en 100 MB.</p>

<h4 id="desfragmentación">Desfragmentación</h4>

<p>Hasta ahora, prácticamente todo lo que hemos visto de <em>Btrfs</em> han sido aspectos positivos, pero tiene un pequeño punto negativo, y éste es, que sufre fragmentación. Sin embargo, también disponemos de una herramienta para aplicar una <strong>desfragmentación</strong> en caso de que fuera necesario.</p>

<p>Si queremos realizar una desfragmentación tenemos que introducir el siguiente comando:</p>

<pre>
root@btrfs:~# btrfs filesystem defrag /mnt
</pre>

<p>Si queremos realizar una desfragmentación recursiva tenemos que introducir el siguiente comando:</p>

<pre>
root@btrfs:~# btrfs filesystem defrag -r /mnt
</pre>

<p>Listo.</p>

<h4 id="conversión-de-sistemas-de-ficheros-basados-en-ext">Conversión de sistemas de ficheros basados en ext*</h4>

<p>Otra de las características de <em>Btrfs</em>, es que permite convertir sistemas <strong>ext2</strong>, <strong>ext3</strong> y <strong>ext4</strong> a <strong>Btrfs</strong>.</p>

<p>Las conversiones deben realizarse en sistemas de ficheros que se encuentran desmontados.</p>

<p>Explicado esto, vamos a realizar una conversión de un sistema de ficheros <em>ext4</em> a <em>Btrfs</em>, para ello voy a formatear el dispositivo <code class="language-plaintext highlighter-rouge">vdf</code> con un sistema de ficheros <em>ext4</em>:</p>

<pre>
root@btrfs:~# mkfs.ext4 /dev/vdf
mke2fs 1.44.5 (15-Dec-2018)
/dev/vdf contains a btrfs file system
Proceed anyway? (y,N) y
Creating filesystem with 262144 4k blocks and 65536 inodes
Filesystem UUID: a8e136e4-06a5-4183-ae6a-e22dca2a4658
Superblock backups stored on blocks:
	32768, 98304, 163840, 229376

Allocating group tables: done                            
Writing inode tables: done                            
Creating journal (8192 blocks): done
Writing superblocks and filesystem accounting information: done

root@btrfs:~# lsblk -f | grep 'vdf'
vdf    ext4         a8e136e4-06a5-4183-ae6a-e22dca2a4658
</pre>

<p>Hecho esto, y desmontado, vamos a usar <code class="language-plaintext highlighter-rouge">btrfs-convert</code> para convertir el dispositivo con formato <em>ext4</em> a un dispositivo formateado en <em>Btrfs</em>:</p>

<pre>
root@btrfs:~# btrfs-convert /dev/vdf
-bash: btrfs-convert: command not found
</pre>

<p>Como se puede ver, me aparece que no dispongo del comando <code class="language-plaintext highlighter-rouge">btrfs-convert</code> y según lo que he leído, esta herramienta se incluye en el paquete <code class="language-plaintext highlighter-rouge">btrfs-progs</code> y dicho paquete se encuentra instalado. Bueno, en caso de tener disponible el comando <code class="language-plaintext highlighter-rouge">btrfs-convert</code>, esta sería la manera de utilizarlo.</p>

<p>Por último, debemos editar el fichero <code class="language-plaintext highlighter-rouge">/etc/fstab</code> para cambiar la columna del sistema de ficheros de <em>ext4</em> a <em>Btrfs</em>.</p>

<h4 id="cifrado">Cifrado</h4>

<p>Para finalizar el artículo, vamos a ver el <strong>cifrado</strong> con <em>Btrfs</em>.</p>

<p>Necesitamos instalar el siguiente paquete en nuestro sistema:</p>

<pre>
apt install cryptsetup -y
</pre>

<p>Una vez instalado, vamos a crear un fichero llamado <em>KeyFile</em> y lo cifraremos:</p>

<pre>
root@btrfs:~# dd if=/dev/urandom of=/root/KeyFile bs=1 count=4096
4096+0 records in
4096+0 records out
4096 bytes (4.1 kB, 4.0 KiB) copied, 0.018509 s, 221 kB/s
</pre>

<p>Vamos a cifrar el disco <code class="language-plaintext highlighter-rouge">vdf</code> con el comando:</p>

<pre>
root@btrfs:~# dd if=/dev/urandom of=/root/KeyFile bs=1 count=4096
4096+0 records in
4096+0 records out
4096 bytes (4.1 kB, 4.0 KiB) copied, 0.0185828 s, 220 kB/s
root@btrfs:~# cryptsetup luksFormat --key-file /root/KeyFile /dev/vdf
WARNING: Device /dev/vdf already contains a 'btrfs' superblock signature.

WARNING!
========
This will overwrite data on /dev/vdf irrevocably.

Are you sure? (Type uppercase yes): YES
</pre>

<p>El disco ya se encontraría cifrado, pero si queremos que utilice una contraseña debemos usar este comando:</p>

<pre>
root@btrfs:~# cryptsetup luksFormat /dev/vdf
WARNING: Device /dev/vdf already contains a 'crypto_LUKS' superblock signature.

WARNING!
========
This will overwrite data on /dev/vdf irrevocably.

Are you sure? (Type uppercase yes): YES
Enter passphrase for /dev/vdf:
Verify passphrase:
</pre>

<p>Para descifrar el disco, introduciremos:</p>

<pre>
root@btrfs:~# cryptsetup open /dev/vdf vdf
Enter passphrase for /dev/vdf:
</pre>

<p>Una vez introducida la contraseña habríamos terminado.</p>

<p>Vistos estos apartados, el contenido de este <em>post</em> habría finalizado.</p>

  </div><a class="u-url" href="/blog/sistemas-de-ficheros-avanzados-Btrfs" hidden></a>
</article>
<footer class="relative bg-gray-300 pt-8 pb-6">

  <div class="container mx-auto px-4">
    <div class="flex flex-wrap">
      <div class="w-full lg:w-5/12 px-4">
        <h4 class="text-3xl font-semibold">
          ¡Más sobre mí!
        </h4>
        <h5 class="text-lg mt-0 mb-2 text-gray-700">
	        Puedes encontrarme en cualquiera de estas plataformas, ¡agradeceré que te pases!
	      </h5>
        <div class="mt-6">
          <button
            class="bg-white text-blue-600 shadow-lg font-normal h-10 w-10 items-center justify-center align-center rounded-full outline-none focus:outline-none mr-2 p-3"
            type="button"
            onclick="location.href='https://www.linkedin.com/in/javier-p%C3%A9rez-hidalgo/';">
            <i class="flex fab fa-linkedin"></i>
          </button>
          <button
            class="bg-white text-gray-900 shadow-lg font-normal h-10 w-10 items-center justify-center align-center rounded-full outline-none focus:outline-none mr-2 p-3"
            type="button"
            onclick="location.href='https://github.com/javierpzh';">
	          <i class="flex fab fa-github"></i>
          </button>
        </div>
        <div class="text-gray-600 text-sm py-1 mt-4">
	        </a
	          class="text-gray-600 hover:text-gray-900"
          > &nbsp;<a target="_blank" rel="noreferrer"></a>
        </div>
      </div>
      <div class="w-full lg:w-6/12 px-4">
        <div class="flex flex-wrap items-top mb-6 mt-4">
          <div class="w-full lg:w-4/12 md:w-6/12 px-0 ml-auto">
            <span
              class="block uppercase text-gray-600 text-sm font-semibold mb-2">
              Enlaces de ayuda
            </span>
            <ul class="list-unstyled">
              <li>
                <a
                  class="text-gray-700 hover:text-gray-900 font-semibold block pb-2 text-sm"
                  href="/">
                  Inicio
                </a>
              </li>
              <li>
                <a
                  class="text-gray-700 hover:text-gray-900 font-semibold block pb-2 text-sm"
                  href="/about">
                  Sobre mí
                </a>
              </li>
              <li>
                <a
                  class="text-gray-700 hover:text-gray-900 font-semibold block pb-2 text-sm"
                  href="/blog">
                  Blog
                </a>
              </li>
              <li>
                <a
                  class="text-gray-700 hover:text-gray-900 font-semibold block pb-2 text-sm"
                  href="https://www.linkedin.com/in/javier-p%C3%A9rez-hidalgo/">
                  LinkedIn
                </a>
              </li>
              <li>
                <a
                  class="text-gray-700 hover:text-gray-900 font-semibold block pb-2 text-sm"
                  href="https://www.github.com/javierpzh">
                  GitHub
                </a>
              </li>
            </ul>
          </div>
          <!-- <div class="w-full lg:w-4/12 md:w-6/12 mt-4 sm:mt-0 md:px-4">
            <span
              class="block uppercase text-gray-600 text-sm font-semibold mb-2">
              Otros recursos
            </span>
            <ul class="list-unstyled">
              <li>
                <a
                  class="text-gray-700 hover:text-gray-900 font-semibold block pb-2 text-sm"
                  href="/privacy-policy">
                  Privacy Policy
                </a>
              </li>
            </ul>
          </div> -->
        </div>
      </div>
    </div>
    <hr class="my-6 border-gray-400" />
    <div
      class="flex flex-wrap items-center md:justify-between justify-center"
    >
      <div class="w-full px-4 mx-auto text-center">
        <div class="text-sm text-gray-600">
            Designed by <a class="hover:text-indigo-600 font-semibold" href="/" target="_blank" rel="noreferrer">Javier Pérez Hidalgo</a>
            &nbsp;
            •
            &nbsp;
            Copyright © 2023&nbsp;<a class="hover:text-indigo-600 font-semibold" href="" target="_blank" rel="noreferrer"></a>
        </div>
      </div>
    </div>
  </div>
</footer><script async defer src="https://sdk.soopr.co/soopr.js"></script></body>

</html>

<!DOCTYPE html>
<html lang="es">

<head>
            <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">


        <title>Cifrado asimétrico con gpg y openssl | Javier Pérez Hidalgo</title>

        <!-- Bootstrap Core CSS -->
        <link href="/theme/css/bootstrap.min.css" rel="stylesheet">

        <!-- Custom CSS -->
        <link href="/theme/css/clean-blog.min.css" rel="stylesheet">

        <!-- Code highlight color scheme -->
            <link href="/theme/css/code_blocks/darkly.css" rel="stylesheet">


        <!-- Custom Fonts -->
        <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
        <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

        <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->



        <meta name="description" content="Cifrado asimétrico con gpg En esta práctica vamos a cifrar ficheros utilizando cifrado asimétrico utilizando el programa gpg. Puedes...">

        <meta name="author" content="Javier Pérez Hidalgo">

        <meta name="tags" content="GPG">
        <meta name="tags" content="OpenSSL">
        <meta name="tags" content="cifrado">

	                <meta property="og:locale" content="">
		<meta property="og:site_name" content="Javier Pérez Hidalgo">

	<meta property="og:type" content="article">
            <meta property="article:author" content="/author/javier-perez-hidalgo.html">
	<meta property="og:url" content="/cifrado-asimetrico-con-gpg-y-openssl.html">
	<meta property="og:title" content="Cifrado asimétrico con gpg y openssl">
	<meta property="article:published_time" content="2020-10-13 00:00:00+02:00">
            <meta property="og:description" content="Cifrado asimétrico con gpg En esta práctica vamos a cifrar ficheros utilizando cifrado asimétrico utilizando el programa gpg. Puedes...">

            <meta property="og:image" content="theme/images/banner-seguridad.jpg">
</head>

<body class="article-cifrado-asimetrico-con-gpg-y-openssl">

    <!-- Navigation -->
    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
        <!--    <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>-->
                <a class="navbar-brand" href="/">Inicio</a>
                <a class="navbar-brand" href="/categories">Categorías</a>
                <a class="navbar-brand" href="/authors">Sobre mí</a>

            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">

                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Page Header -->
        <header class="intro-header" style="background-image: url('/theme/images/banner-seguridad.jpg')">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <div class="post-heading">
                        <h1>Cifrado asimétrico con gpg y openssl</h1>
                        <span class="meta">Publicado por
                                <a href="/author/javier-perez-hidalgo.html">Javier Pérez Hidalgo</a>
                             el mar 13 octubre 2020
                        </span>
                        
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
    <!-- Post Content -->
    <article>
        <h2>Cifrado asimétrico con gpg</h2>
<p>En esta práctica vamos a cifrar ficheros utilizando cifrado asimétrico utilizando el programa gpg. Puedes encontrar el resumen de comando en esta <a href="https://elbauldelprogramador.com/chuleta-de-comandos-para-gpg/">chuleta</a> o buscar información en internet.</p>
<h3>Tarea 1: Generación de claves.</h3>
<p>Los algoritmos de cifrado asimétrico utilizan dos claves para el cifrado y descifrado de mensajes. Cada persona involucrada (receptor y emisor) debe disponer, por tanto, de una pareja de claves pública y privada. Para generar nuestra pareja de claves con gpg utilizamos la opción <code>--gen-key</code>:</p>
<p>Para esta práctica no es necesario que indiquemos frase de paso en la generación de las claves (al menos para la clave pública).</p>
<p><strong>1. Genera un par de claves (pública y privada). ¿En que directorio se guarda las claves de un usuario?</strong></p>
<p>Para generar un nuevo par de claves, utilizamos el siguiente comando:</p>
<pre>
gpg --gen-key
</pre>

<p>Aquí muestro como lo he realizado yo:</p>
<pre>
javier@debian:~$ gpg --gen-key
gpg (GnuPG) 2.2.12; Copyright (C) 2018 Free Software Foundation, Inc.
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

Nota: Usa "gpg --full-generate-key" para el diálogo completo de generación de clave.

GnuPG debe construir un ID de usuario para identificar su clave.

Nombre y apellidos: Javier Pérez Hidalgo
Dirección de correo electrónico: reyole111@gmail.com
Está usando el juego de caracteres 'utf-8'.
Ha seleccionado este ID de usuario:
    "Javier Pérez Hidalgo <reyole111@gmail.com>"

¿Cambia (N)ombre, (D)irección o (V)ale/(S)alir? v
Es necesario generar muchos bytes aleatorios. Es una buena idea realizar
alguna otra tarea (trabajar en otra ventana/consola, mover el ratón, usar
la red y los discos) durante la generación de números primos. Esto da al
generador de números aleatorios mayor oportunidad de recoger suficiente
entropía.
Es necesario generar muchos bytes aleatorios. Es una buena idea realizar
alguna otra tarea (trabajar en otra ventana/consola, mover el ratón, usar
la red y los discos) durante la generación de números primos. Esto da al
generador de números aleatorios mayor oportunidad de recoger suficiente
entropía.
gpg: clave E446ACC5CFC7D182 marcada como de confianza absoluta
gpg: creado el directorio '/home/javier/.gnupg/openpgp-revocs.d'
gpg: certificado de revocación guardado como '/home/javier/.gnupg/openpgp-revocs.d/17A7AC2D8A4E98A191B8A5A7E446ACC5CFC7D182.rev'
claves pública y secreta creadas y firmadas.

pub   rsa3072 2020-10-06 [SC] [caduca: 2022-10-06]
      17A7AC2D8A4E98A191B8A5A7E446ACC5CFC7D182
uid                      Javier Pérez Hidalgo <reyole111@gmail.com>
sub   rsa3072 2020-10-06 [E] [caduca: 2022-10-06]
</pre>

<p>Antes de completar el proceso nos va a saltar una ventana donde vamos a tener que especificar nuestra contraseña.
Las claves y los datos que se crean se guardan en el directorio '.gnupg'.</p>
<p><strong>2. Lista las claves públicas que tienes en tu almacén de claves. Explica los distintos datos que nos muestra. ¿Cómo deberías haber generado las claves para indicar, por ejemplo, que tenga un 1 mes de validez?</strong></p>
<p>Para listar las claves de nuestro anillo de claves públicas:</p>
<pre>
javier@debian:~/.gnupg$ gpg --list-keys
/home/javier/.gnupg/pubring.kbx
-------------------------------
pub   rsa3072 2020-10-06 [SC] [caduca: 2022-10-06]
      17A7AC2D8A4E98A191B8A5A7E446ACC5CFC7D182
uid        [  absoluta ] Javier Pérez Hidalgo <reyole111@gmail.com>
sub   rsa3072 2020-10-06 [E] [caduca: 2022-10-06]
</pre>

<p>Nos muestra la fecha de creación, la fecha de caducidad, el identificador, el nombre que le hemos puesto y el correo electrónico.</p>
<p>Para generar una clave pública-privada que tengan un mes de validez, debemos usar el siguiente comando, en el que podemos especificar además, más opciones y parámetros por si no queremos los predeterminados:</p>
<pre>
javier@debian:~/.gnupg$ gpg --full-generate-key
gpg (GnuPG) 2.2.12; Copyright (C) 2018 Free Software Foundation, Inc.
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

Por favor seleccione tipo de clave deseado:
   (1) RSA y RSA (por defecto)
   (2) DSA y ElGamal
   (3) DSA (sólo firmar)
   (4) RSA (sólo firmar)
Su elección: 1
las claves RSA pueden tener entre 1024 y 4096 bits de longitud.
¿De qué tamaño quiere la clave? (3072)
El tamaño requerido es de 3072 bits
Por favor, especifique el período de validez de la clave.
         0 = la clave nunca caduca
      <n>  = la clave caduca en n días
      <n>w = la clave caduca en n semanas
      <n>m = la clave caduca en n meses
      <n>y = la clave caduca en n años
¿Validez de la clave (0)? 1m
La clave caduca jue 12 nov 2020 16:47:41 CET
¿Es correcto? (s/n) s

GnuPG debe construir un ID de usuario para identificar su clave.

Nombre y apellidos: Javier Pérez Hidalgo
Dirección de correo electrónico: reyole111@gmail.com
Comentario:
Está usando el juego de caracteres 'utf-8'.
Ha seleccionado este ID de usuario:
    "Javier Pérez Hidalgo <reyole111@gmail.com>"

¿Cambia (N)ombre, (C)omentario, (D)irección o (V)ale/(S)alir? s
gpg: Creación de claves cancelada.
</pre>

<p><strong>3. Lista las claves privadas de tu almacén de claves.</strong></p>
<p>Si quisiéramos listar las claves privadas de muestro anillo de claves privadas:</p>
<pre>
gpg --list-secret-keys
</pre>

<h3>Tarea 2: Importar / exportar clave pública.</h3>
<p>Para enviar archivos cifrados a otras personas, necesitamos disponer de sus claves públicas. De la misma manera, si queremos que cierta persona pueda enviarnos datos cifrados, ésta necesita conocer nuestra clave pública. Para ello, podemos hacérsela llegar por email por ejemplo. Cuando recibamos una clave pública de otra persona, ésta deberemos incluirla en nuestro keyring o anillo de claves, que es el lugar donde se almacenan todas las claves públicas de las que disponemos.</p>
<p><strong>1. Exporta tu clave pública en formato ASCII y guárdalo en un archivo nombre_apellido.asc y envíalo al compañero con el que vas a hacer esta práctica.</strong></p>
<p>Para exportar mi clave pública con formato ASCII, indicamos el parámetro <code>--armor</code>, le indicamos con el parámetro <code>--output</code> el nombre que va a recibir la clave y con <code>--export</code> indicamos la clave a exportar.</p>
<pre>
gpg --armor --output javier_perez_hidalgo.asc --export "Javier Pérez Hidalgo"
</pre>

<p>Ahora se la paso a mi compañero <a href="https://www.instagram.com/juanlu_millan/">Juanlu</a>.</p>
<p><strong>2. Importa las claves públicas recibidas de vuestro compañero.</strong></p>
<p>Juanlu me ha pasado su clave pública llamada <code>juanluis_millan.asc</code> y yo la importo a mi anillo de claves públicas.</p>
<pre>
javier@debian:~/Descargas$ gpg --import juanluis_millan.asc
gpg: clave 15E1B16E8352B9BB: clave pública "Juan Luis Millan Hidalgo <juanluismillanhidalgo@gmail.com>" importada
gpg: Cantidad total procesada: 1
gpg:               importadas: 1
</pre>

<p>Él también ha incluido mi pública en su anillo de claves públicas.</p>
<p><strong>3. Comprueba que las claves se han incluido correctamente en vuestro keyring.</strong></p>
<p>Compruebo que se ha importado de manera correcta:</p>
<pre>
javier@debian:~/.gnupg$ gpg --list-keys
/home/javier/.gnupg/pubring.kbx
-------------------------------
pub   rsa3072 2020-10-06 [SC] [caduca: 2022-10-06]
      17A7AC2D8A4E98A191B8A5A7E446ACC5CFC7D182
uid        [  absoluta ] Javier Pérez Hidalgo <reyole111@gmail.com>
sub   rsa3072 2020-10-06 [E] [caduca: 2022-10-06]

pub   rsa3072 2020-10-13 [SC] [caduca: 2022-10-13]
      B02B578465B0756DFD271C733E0DA17912B9A4F8
uid        [desconocida] Álvaro Vaca Ferreras <avacaferreras@gmail.com>
sub   rsa3072 2020-10-13 [E] [caduca: 2022-10-13]

pub   rsa3072 2020-10-07 [SC] [caduca: 2022-10-07]
      4C220919DD2364BED7D49C3215E1B16E8352B9BB
uid        [desconocida] Juan Luis Millan Hidalgo <juanluismillanhidalgo@gmail.com>
sub   rsa3072 2020-10-07 [E] [caduca: 2022-10-07]
</pre>

<p>Vemos que la tenemos almacenada, por tanto ya podríamos enviarnos archivos encriptados.</p>
<h3>Tarea 3: Cifrado asimétrico con claves públicas.</h3>
<p>Tras realizar el ejercicio anterior, podemos enviar ya documentos cifrados utilizando la clave pública de los destinatarios del mensaje.</p>
<p><strong>1. Cifraremos un archivo cualquiera y lo remitiremos por email a uno de nuestros compañeros que nos proporcionó su clave pública.</strong></p>
<p>He creado un archivo llamado <code>prueba_para_juanlu.txt</code> y lo encripto con la clave pública de Juanlu para que solo él con su clave privada pueda descifrarlo.</p>
<pre>
javier@debian:~/Descargas$ gpg -r juanluismillanhidalgo@gmail.com --encrypt prueba_para_juanlu.txt
gpg: 988EDEB8C4FF299C: No hay seguridad de que esta clave pertenezca realmente
al usuario que se nombra

sub  rsa3072/988EDEB8C4FF299C 2020-10-07 Juan Luis Millan Hidalgo <juanluismillanhidalgo@gmail.com>
 Huella clave primaria: 4C22 0919 DD23 64BE D7D4  9C32 15E1 B16E 8352 B9BB
      Huella de subclave: 92ED 2E50 2319 E80D 5B0A  D728 988E DEB8 C4FF 299C

No es seguro que la clave pertenezca a la persona que se nombra en el
identificador de usuario. Si *realmente* sabe lo que está haciendo,
puede contestar sí a la siguiente pregunta.

¿Usar esta clave de todas formas? (s/N) s
</pre>

<p>Una vez cifrado, se lo envío.</p>
<p><strong>2. Nuestro compañero, a su vez, nos remitirá un archivo cifrado para que nosotros lo descifremos.</strong></p>
<p>Mi compañero me ha pasado un archivo encriptado por él con mi clave pública, que se llama <code>hola.txt.gpg</code>.</p>
<pre>
javier@debian:~/Descargas$ ls
hola.txt.gpg  juanluis_millan.asc     prueba_para_juanlu.txt.gpg
Imágenes      prueba_para_juanlu.txt
</pre>

<p><strong>3. Tanto nosotros como nuestro compañero comprobaremos que hemos podido descifrar los mensajes recibidos respectivamente.</strong></p>
<p>Voy a descifrar el archivo con mi clave privada.</p>
<pre>
javier@debian:~/Descargas$ gpg --decrypt hola.txt.gpg
gpg: cifrado con clave de 3072 bits RSA, ID 1A5336E5C764C497, creada el 2020-10-06
      "Javier Pérez Hidalgo <reyole111@gmail.com>"
hola compañero javier
</pre>

<p>Vemos como lo hemos descifrado correctamente y que ya podemos leer el mensaje que Juanlu me quería hacer llegar.</p>
<p><strong>4. Por último, enviaremos el documento cifrado a alguien que no estaba en la lista de destinatarios y comprobaremos que este usuario no podrá descifrar este archivo.</strong></p>
<p>Voy a quitar la clave pública de Juanlu para ver como efectivamente, ya no podré descifrar el fichero que Juanlu me envíe encriptado con su clave privada.</p>
<pre>
javier@debian:~/.gnupg$ gpg --list-keys
/home/javier/.gnupg/pubring.kbx
-------------------------------
pub   rsa3072 2020-10-06 [SC] [caduca: 2022-10-06]
      17A7AC2D8A4E98A191B8A5A7E446ACC5CFC7D182
uid        [  absoluta ] Javier Pérez Hidalgo <reyole111@gmail.com>
sub   rsa3072 2020-10-06 [E] [caduca: 2022-10-06]

pub   rsa3072 2020-10-13 [SC] [caduca: 2022-10-13]
      B02B578465B0756DFD271C733E0DA17912B9A4F8
uid        [desconocida] Álvaro Vaca Ferreras <avacaferreras@gmail.com>
sub   rsa3072 2020-10-13 [E] [caduca: 2022-10-13]

pub   rsa3072 2020-10-07 [SC] [caduca: 2022-10-07]
      4C220919DD2364BED7D49C3215E1B16E8352B9BB
uid        [desconocida] Juan Luis Millan Hidalgo <juanluismillanhidalgo@gmail.com>
sub   rsa3072 2020-10-07 [E] [caduca: 2022-10-07]

javier@debian:~/.gnupg$ gpg --delete-key Juan Luis Millan Hidalgo
gpg (GnuPG) 2.2.12; Copyright (C) 2018 Free Software Foundation, Inc.
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.


pub  rsa3072/15E1B16E8352B9BB 2020-10-07 Juan Luis Millan Hidalgo <juanluismillanhidalgo@gmail.com>

¿Eliminar esta clave del anillo? (s/N) s
gpg: clave "Luis" no encontrada: Not found
gpg: Luis: delete key failed: Not found

javier@debian:~/.gnupg$ gpg --list-keys
/home/javier/.gnupg/pubring.kbx
-------------------------------
pub   rsa3072 2020-10-06 [SC] [caduca: 2022-10-06]
      17A7AC2D8A4E98A191B8A5A7E446ACC5CFC7D182
uid        [  absoluta ] Javier Pérez Hidalgo <reyole111@gmail.com>
sub   rsa3072 2020-10-06 [E] [caduca: 2022-10-06]

pub   rsa3072 2020-10-13 [SC] [caduca: 2022-10-13]
      B02B578465B0756DFD271C733E0DA17912B9A4F8
uid        [desconocida] Álvaro Vaca Ferreras <avacaferreras@gmail.com>
sub   rsa3072 2020-10-13 [E] [caduca: 2022-10-13]
</pre>

<p>Aquí muestro como he borrado su clave de mi anillo. A su vez, él también ha borrado mi clave de su anillo, y ahora voy a cifrar un archivo con mi privada que él no podrá descifrar.</p>
<pre>
javier@debian:~/Descargas$ touch prueba_para_juanlu_2.txt

javier@debian:~/Descargas$ nano prueba_para_juanlu_2.txt

javier@debian:~/Descargas$ gpg -r reyole111@gmail.com --encrypt prueba_para_juanlu_2.txt
</pre>

<p>Juanlu me envía un elemento cifrado llamado <code>hola1.txt.gpg</code>, voy a intentar descifrarlo.</p>
<pre>
javier@debian:~/Descargas$ ls
hola1.txt.gpg  Imágenes             prueba_para_juanlu_2.txt      prueba_para_juanlu.txt
hola.txt.gpg   juanluis_millan.asc  prueba_para_juanlu_2.txt.gpg  prueba_para_juanlu.txt.gpg

javier@debian:~/Descargas$ gpg --decrypt hola1.txt.gpg
gpg: cifrado con clave RSA, ID 988EDEB8C4FF299C
gpg: descifrado fallido: No secret key
</pre>

<p>Aquí vemos como me da error y me dice que no puedo descifrarlo porque no poseo la clave correcta.</p>
<p><strong>5. Para terminar, indica los comandos necesarios para borrar las claves públicas y privadas que posees.</strong></p>
<p>Para borrar cualquier clave pública:</p>
<pre>
gpg --delete-key "(identificador)"
</pre>

<p>Para borrar cualquier clave privada:</p>
<pre>
gpg --delete-secret-key "(identificador)"
</pre>

<h3>Tarea 4: Exportar clave a un servidor público de claves PGP.</h3>
<p>Para distribuir las claves públicas es mucho más habitual utilizar un servidor específico para distribuirlas, que permite a los clientes añadir las claves públicas a sus anillos de forma mucho más sencilla.</p>
<p><strong>1. Genera la clave de revocación de tu clave pública para utilizarla en caso de que haya problemas.</strong></p>
<p>Voy a generar la clave de revocación de mi clave pública.</p>
<pre>
javier@debian:~/.gnupg$ gpg -k
/home/javier/.gnupg/pubring.kbx
-------------------------------
pub   rsa3072 2020-10-06 [SC] [caduca: 2022-10-06]
      17A7AC2D8A4E98A191B8A5A7E446ACC5CFC7D182
uid        [  absoluta ] Javier Pérez Hidalgo <reyole111@gmail.com>
sub   rsa3072 2020-10-06 [E] [caduca: 2022-10-06]

pub   rsa3072 2020-10-13 [SC] [caduca: 2022-10-13]
      B02B578465B0756DFD271C733E0DA17912B9A4F8
uid        [desconocida] Álvaro Vaca Ferreras <avacaferreras@gmail.com>
sub   rsa3072 2020-10-13 [E] [caduca: 2022-10-13]

javier@debian:~/.gnupg$ gpg --output javier_perez_hidalgo_revocacion.asc --gen-revoke 17A7AC2D8A4E98A191B8A5A7E446ACC5CFC7D182

sec  rsa3072/E446ACC5CFC7D182 2020-10-06 Javier Pérez Hidalgo <reyole111@gmail.com>

¿Crear un certificado de revocación para esta clave? (s/N) s
Por favor elija una razón para la revocación:
  0 = No se dio ninguna razón
  1 = La clave ha sido comprometida
  2 = La clave ha sido reemplazada
  3 = La clave ya no está en uso
  Q = Cancelar
(Probablemente quería seleccionar 1 aquí)
¿Su decisión? 1
Introduzca una descripción opcional; acábela con una línea vacía:

Razón para la revocación: La clave ha sido comprometida
(No se dió descripción)
¿Es correcto? (s/N) s
se fuerza salida con armadura ASCII.
Certificado de revocación creado.

Por favor consérvelo en un medio que pueda esconder; si alguien consigue
acceso a este certificado puede usarlo para inutilizar su clave.
Es inteligente imprimir este certificado y guardarlo en otro lugar, por
si acaso su medio resulta imposible de leer. Pero precaución: ¡el sistema
de impresión de su máquina podría almacenar los datos y hacerlos accesibles
a otras personas!
</pre>

<p><strong>2. Exporta tu clave pública al servidor <code>pgp.rediris.es</code> .</strong></p>
<p>El servidor <code>pgp.rediris.es</code> no funcionaba correctamente en este momento por tanto la he enviado a este otro servidor: <code>keys.gnupg.net</code>.</p>
<pre>
javier@debian:~/.gnupg$ gpg --keyserver keys.gnupg.net --send-key 17A7AC2D8A4E98A191B8A5A7E446ACC5CFC7D182
gpg: enviando clave E446ACC5CFC7D182 a hkp://hkps.pool.sks-keyservers.net
</pre>

<p><strong>3. Borra la clave pública de alguno de tus compañeros de clase e impórtala ahora del servidor público de rediris.</strong></p>
<p>Voy a intentar importar la clave de Juanlu que previamente ha subido a este servidor:</p>
<pre>
javier@debian:~/.gnupg$ gpg --recv-keys --keyserver keys.gnupg.net 4C220919DD2364BED7D49C3215E1B16E8352B9BB
gpg: clave 15E1B16E8352B9BB: clave pública "Juan Luis Millan Hidalgo <juanluismillanhidalgo@gmail.com>" importada
gpg: Cantidad total procesada: 1
gpg:               importadas: 1
</pre>

<p>Vemos como la hemos importado correctamente a nuestro anillo de claves.</p>
<h3>Tarea 5: Cifrado asimétrico con openssl.</h3>
<p>En esta ocasión vamos a cifrar nuestros ficheros de forma asimétrica utilizando la herramienta openssl.</p>
<p><strong>1. Genera un par de claves (pública y privada).</strong></p>
<p>Para generar un par de claves openssl:</p>
<pre>
javier@debian:~$ openssl genrsa -aes128 -out javier_perez_hidalgo_key.pem 2048
Generating RSA private key, 2048 bit long modulus (2 primes)
...........+++++
.................................+++++
e is 65537 (0x010001)
Enter pass phrase for javier_perez_hidalgo_key.pem:
Verifying - Enter pass phrase for javier_perez_hidalgo_key.pem:

javier@debian:~$ ls
 Descargas    Escritorio                     Música       Vagrant           virtualenv
 Documentos   Imágenes                       Plantillas   Vídeos
 Dropbox      javier_perez_hidalgo_key.pem   Público     'VirtualBox VMs'
</pre>

<pre>
javier@debian:~$ openssl rsa -in javier_perez_hidalgo_key.pem -out javier_perez_hidalgo_key.pub.pem -outform PEM -pubout
Enter pass phrase for javier_perez_hidalgo_key.pem:
writing RSA key
</pre>

<p>Podemos ver como las hemos creado correctamente.</p>
<p><strong>2. Envía tu clave pública a un compañero.</strong></p>
<p>Le he enviado mi clave pública <code>javier_perez_hidalgo_key.pub.pem</code> a Juanlu, y él me ha pasado la suya <code>key.pub.pem</code>.</p>
<p><strong>3. Utilizando la clave pública cifra un fichero de texto y envíalo a tu compañero.</strong></p>
<p>Voy a crear un fichero de texto, lo voy a cifrar con la pública de Juanlu y se lo voy a enviar.</p>
<pre>
javier@debian:~/Descargas$ touch prueba_juanlu_openssl.txt

javier@debian:~/Descargas$ nano prueba_juanlu_openssl.txt

javier@debian:~/Descargas$ openssl rsautl -pubin -encrypt -in prueba_juanlu_openssl.txt -out prueba_juanlu_openssl.enc -inkey key.pub.pem

javier@debian:~/Descargas$ ls
hola1.txt.gpg        key.pub.pem                prueba_para_juanlu_2.txt.gpg
hola.txt.gpg         prueba_juanlu_openssl.enc  prueba_para_juanlu.txt
Imágenes             prueba_juanlu_openssl.txt  prueba_para_juanlu.txt.gpg
juanluis_millan.asc  prueba_para_juanlu_2.txt
</pre>

<p><strong>4. Tu compañero te ha mandado un fichero cifrado, muestra el proceso para el descifrado.</strong></p>
<p>Juanlu me acaba de enviar un fichero cifrado supuestamente con mi clave pública, por tanto yo no tendría que tener ningún problema a la hora de descifrarlo. El archivo se llama <code>holaejemplo.enc</code>.</p>
<pre>
javier@debian:~/Descargas$ ls
hola1.txt.gpg    Imágenes             prueba_juanlu_openssl.enc  prueba_para_juanlu_2.txt.gpg
holaejemplo.enc  juanluis_millan.asc  prueba_juanlu_openssl.txt  prueba_para_juanlu.txt
hola.txt.gpg     key.pub.pem          prueba_para_juanlu_2.txt   prueba_para_juanlu.txt.gpg

javier@debian:~/Descargas$ openssl rsautl -decrypt -inkey ../javier_perez_hidalgo_key.pem -in holaejemplo.enc -out holaejemplo.dec
Enter pass phrase for ../javier_perez_hidalgo_key.pem:

javier@debian:~/Descargas$ cat holaejemplo.dec
hola compañero javier
</pre>

<p>Vemos como lo he descifrado y he podido leer su mensaje.</p>
    </article>

        <div class="tags">
            <p><strong><a href="/tags">tags:</a></strong> <a href="/tag/gpg.html">GPG</a>, <a href="/tag/openssl.html">OpenSSL</a>, <a href="/tag/cifrado.html">cifrado</a></p>
        </div>

    <hr>

            </div>
        </div>
    </div>

    <hr>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <ul class="list-inline text-center">
                            <li>
                                <a href="https://www.instagram.com/javierpzh/">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-instagram fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                            <li>
                                <a href="https://twitter.com/jperezhid_">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                            <li>
                                <a href="https://github.com/javierpzh">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                            <li>
                                <a href="https://www.linkedin.com/in/javier-p%C3%A9rez-hidalgo/">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                            <li>
                                <a href="mailto:javierperezhidalgo01@gmail.com">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-envelope-square fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                    </ul>
<p class="copyright text-muted">
    Blog creado por <a href="http://www.instagram.com/javierpzh/">Javier Pérez Hidalgo</a>,
    con la utilización de <a href="https://blog.getpelican.com/">Pelican</a>. <br />        &copy;  Javier Pérez Hidalgo
</p>                </div>
            </div>
        </div>
    </footer>

    <!-- jQuery -->
    <script src="/theme/js/jquery.min.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="/theme/js/bootstrap.min.js"></script>

        <!-- Custom Theme JavaScript -->
        <script src="/theme/js/clean-blog.min.js"></script>

</body>

</html>